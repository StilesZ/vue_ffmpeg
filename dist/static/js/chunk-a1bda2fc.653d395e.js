(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a1bda2fc"],{"0333":function(e,t,a){"use strict";a("b25f")},"070b":function(e,t,a){"use strict";a("474d")},"1dfe":function(e,t,a){"use strict";a.r(t);var i,s,n,o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"clearfix my-page-list"},[a("div",{staticClass:"page-search-wrapper bg-white"},[a("el-tabs",{on:{"tab-click":e.handlePageModeClick},model:{value:e.searchParams.pageMode,callback:function(t){e.$set(e.searchParams,"pageMode",t)},expression:"searchParams.pageMode"}},e._l(e.pageModeList,(function(t,i){return a("el-tab-pane",{key:i,attrs:{name:t.value,disabled:t.disabled}},[a("div",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"nav-tabs-label"},[e._v(e._s(t.label))])])])})),1)],1),a("el-scrollbar",{staticClass:"scroll-wrapper page-list-wrapper"},[a("div",{staticClass:"page-content"},[a("div",{staticClass:"my-page-nav-list"},[a("div",{staticClass:"my-page-nav-item",class:{active:"my"===e.searchParams.type},on:{click:function(t){return e.doSearch("my")}}},[e._v("\n          我的作品("+e._s(e.myCount)+")\n        ")]),a("div",{staticClass:"my-page-nav-item",class:{active:"cooperation"===e.searchParams.type},on:{click:function(t){return e.doSearch("cooperation")}}},[e._v("\n          参与作品("+e._s(e.shareCount)+")\n        ")])]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"page-item-wrapper"},[a("div",{staticClass:"page-item"},[a("thumbnailPanel",{attrs:{pageType:e.searchParams.pageMode}})],1),e._l(e.pageList,(function(t,i){return a("div",{key:i,staticClass:"page-item"},[a("thumbnailPanel",{attrs:{pageData:t,btnList:e.operationBtn(t.isPublish)},on:{refresh:e.getPageList,showPreview:e.showPreviewFn}})],1)}))],2)])]),e.showPreview?a("previewPage",{attrs:{pageId:e.previewId},on:{closePreview:function(t){e.showPreview=!1}}}):e._e()],1)},r=[],c=(a("7f7f"),a("2909")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.pageData?a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"page-thumbnail-panel"},[a("div",{staticClass:"thumbnail-panel-cover"},[a("div",{staticClass:"header-mask"},[a("div",{staticClass:"details-btn",on:{click:function(t){return e.preview(e.pageData._id)}}},[e._v("预览")])]),a("div",{staticClass:"image-wrapper"},[a("img",{attrs:{src:e.pageData.coverImage||e.defaultCoverImage,alt:""}})])]),a("div",{staticClass:"page-item-title border-T ellipsis"},[a("span",{staticClass:"item-title-i",attrs:{title:e.pageData.title}},[e._v(e._s(e.pageData.title||"未命名作品"))])]),e.btnList.length?a("div",{staticClass:"border-T thumbnail-panel-btn"},[e.btnList.includes("edit")?a("div",{staticClass:"btn-wrapper"},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.edit}},[e._v("编辑")])],1):e._e(),e.btnList.includes("useTemplate")?a("div",{staticClass:"btn-wrapper"},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.copyPage}},[e._v("使用模板")])],1):e._e(),e.btnList.includes("copyTemplate")?a("div",{staticClass:"btn-wrapper"},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.copyPage}},[e._v("复制")])],1):e._e(),e.showMoreBtn?a("div",{staticClass:"btn-wrapper"},[a("el-dropdown",{attrs:{placement:"top-start"},on:{command:e.command}},[a("el-button",{attrs:{type:"text",size:"mini"}},[e._v("\n          更多\n          "),a("i",{staticClass:"el-icon-more-outline"})]),a("el-dropdown-menu",[e._l(e.operationDataList,(function(t,i){return[e.btnList.includes(t.eventType)?a("el-dropdown-item",{key:i,attrs:{command:t.eventType}},[a("div",{class:t.extraClassName},[e._v(e._s(t.title))])]):e._e()]}))],2)],1)],1):e._e()]):e._e()]):a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"page-thumbnail-panel create"},[a("div",{staticClass:"temp-create",on:{click:e.newPage}},[a("i",{staticClass:"el-icon-plus"}),a("p",{staticClass:"paddingT10"},[e._v("新建页面")])])])},p=[],d=(a("1c01"),a("58b2"),a("8e6e"),a("f3e2"),a("d25f"),a("ac6a"),a("456d"),a("ade3")),u=a("5c96"),g=a("fefe"),h=a("2b0e"),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"协作人管理",visible:e.visible,width:"650px"},on:{"update:visible":function(t){e.visible=t}}},[a("div",[a("div",{staticClass:"new-folder-wrapper paddingL30 padingR30"},[a("div",{staticClass:"title"},[e._v("按人员搜索添加(多选):")]),a("div",{staticClass:"search-wrapper"},[a("div",{staticClass:"input-wrapper"},[a("el-select",{staticClass:"input-i",attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入用户名|邮箱|昵称搜索","remote-method":e.remoteMethod_user,loading:e.loading_user},model:{value:e.userInput,callback:function(t){e.userInput=t},expression:"userInput"}},e._l(e.userOptions,(function(e){return a("el-option",{key:e._id,attrs:{label:e.name,value:e._id}})})),1)],1),a("div",{staticClass:"tj-btn"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("添加")])],1)])]),a("div",{staticClass:"user-list-wrapper"},[a("div",{staticClass:"title"},[e._v("已加入成员:")]),a("div",{staticClass:"user-list"},e._l(e.cooperationUserList,(function(t,i){return a("el-tag",{key:i,staticClass:"user-item",attrs:{size:"mini",closable:""},on:{close:function(a){return e.delUser(t._id,i)}}},[a("img",{staticClass:"userHeadImage",attrs:{src:t.avatar||e.userHeadImage,alt:""}}),e._v("\n          "+e._s(t.name)+"\n        ")])})),1)])])])},v=[],f={components:(i={},Object(d["a"])(i,u["Tag"].name,u["Tag"]),Object(d["a"])(i,u["Select"].name,u["Select"]),Object(d["a"])(i,u["Option"].name,u["Option"]),Object(d["a"])(i,u["Form"].name,u["Form"]),Object(d["a"])(i,u["FormItem"].name,u["FormItem"]),Object(d["a"])(i,u["Dialog"].name,u["Dialog"]),Object(d["a"])(i,u["Button"].name,u["Button"]),i),data:function(){return{userHeadImage:a("4b5a"),pageId:"",visible:!1,callback:null,loading_user:!1,groupInput:"",groupOptions:[],userInput:[],userOptions:[],cooperationUserList:[]}},created:function(){this.getCooperationList()},methods:{getCooperationList:function(){var e=this;this.$API.getCooperationUserListByPageId({pageId:this.pageId}).then((function(t){e.cooperationUserList=t.body||[]}))},remoteMethod_user:function(e){var t=this;this.loading_user=!0,this.$API.getUserListByKeywords({keywords:e}).then((function(e){t.userOptions=e.body||[],t.loading_user=!1})).catch((function(){t.loading_user=!0}))},addUser:function(){var e=this;this.userInput.length&&this.$API.addCooperation({pageId:this.pageId,userIds:this.userInput}).then((function(t){e.cooperationUserList=t.body||[],e.userInput=[]}))},delUser:function(e,t){var a=this;this.$API.delCooperation({pageId:this.pageId,userId:e}).then((function(){a.cooperationUserList.splice(t,1)}))}}},b=f,w=(a("5767"),a("2877")),y=Object(w["a"])(b,m,v,!1,null,"699ac552",null),P=y.exports,C=h["default"].extend(P),_=function(e,t){return s=new C({data:{pageId:e}}),s.$mount(),s.callback=t,document.body.appendChild(s.$el),s.visible=!0,s},D=_;function I(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){Object(d["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var $={props:{showPublishState:{type:Boolean,default:!0},showMoreBtn:{type:Boolean,default:!0},pageType:{type:String,default:"h5"},pageData:Object,btnList:{type:Array,default:function(){return[]}}},components:(n={},Object(d["a"])(n,u["Dropdown"].name,u["Dropdown"]),Object(d["a"])(n,u["DropdownMenu"].name,u["DropdownMenu"]),Object(d["a"])(n,u["DropdownItem"].name,u["DropdownItem"]),n),data:function(){return{loading:!1,defaultCoverImage:a("67bf"),operationDataList:[{title:"设为我的模板",eventType:"setTemplate",iconClass:""},{title:"协作设置",eventType:"cooperation",iconClass:""},{title:"删除",eventType:"delete",extraClassName:"error",iconClass:""},{title:"退出协作",eventType:"unCooperation",extraClassName:"error",iconClass:""}]}},methods:{command:function(e){switch(e){case"publish":this.publish();break;case"copyUrl":this.copyUrl();break;case"setTemplate":this.setTemplate();break;case"viewPageData":this.viewPageData();break;case"cooperation":this.cooperation();break;case"delete":this.delete();break;case"unCooperation":this.unCooperation();break;case"publishTemplate":this.publishTemplate();break}},newPage:function(){var e=this,t=g["a"].getProjectConfig();this.loading=!0,this.$API.createPage(O({},t)).then((function(t){e.loading=!1,t.body&&e.$router.push({name:"Editor",query:{id:t.body._id}})})).catch((function(){e.loading=!1}))},edit:function(){this.$router.push({name:"Editor",query:{id:this.pageData._id}})},copyPage:function(){var e=this;this.loading=!0,this.$API.copyPage({id:this.pageData._id}).then((function(t){e.loading=!1,e.$router.push({name:"Editor",query:{id:t.body._id}})})).catch((function(){e.loading=!1}))},publish:function(){var e=this;this.loading=!0,this.$API.publishPage({id:this.pageData._id}).then((function(){e.loading=!1,e.$message.success("发布成功"),e.preview(e.pageData._id),e.$emit("refresh")})).catch((function(){e.loading=!1}))},preview:function(e){this.$emit("showPreview",e)},copyUrl:function(){},setTemplate:function(){var e=this;this.loading=!0,this.$API.setTemplatePage({id:this.pageData._id}).then((function(){e.loading=!1,e.$message.success("已添加到我的模板")})).catch((function(){e.loading=!1}))},viewPageData:function(){this.$router.push({name:"pageDataDetail",query:{id:this.pageData._id}})},cooperation:function(){D(this.pageData._id)},delete:function(){var e=this;this.$alert("确认删除页面？删除后，将无法访问此页面?","操作提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$API.deletePage({id:e.pageData._id}).then((function(){e.$message.success("删除成功！"),e.$emit("refresh")}))}))},unCooperation:function(){var e=this;this.$alert("确认退出协作编辑？退出后，将无法编辑此页面?","操作提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$API.delCooperation({pageId:e.pageData._id,userId:e.$store.state.user.userInfo._id}).then((function(){e.$message.success("已退出！"),e.$emit("refresh")}))}))},publishTemplate:function(){var e=this;this.loading=!0,this.$API.publishPage({id:this.pageData._id}).then((function(){e.loading=!1,e.$message.success("发布成功")})).catch((function(){e.loading=!1}))}}},k=$,j=(a("0333"),Object(w["a"])(k,l,p,!1,null,"0b979233",null)),L=j.exports,x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("previewWrapper",{attrs:{pageData:e.pageData,videoUrl:e.pageData.videoUrl,showVideo:!!e.pageData.videoUrl},on:{closePanel:e.closePanel}}),a("el-dialog",{attrs:{title:"提示",visible:e.showDialog,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.showDialog=t}}},[a("span",[e._v("暂时没有合成视频")])])],1)},T=[],U=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"components-preview"},[a("div",{staticClass:"setting-bg"}),e.showVideo?a("div",{staticClass:"preview-con"},[a("div",{staticClass:"center-panel",style:e.style()},[a("video",{attrs:{controls:""}},[a("source",{attrs:{src:e.videoUrl,type:"video/mp4"}})])]),a("span",{staticClass:"close-btn",on:{click:e.closePanel}},[a("i",{staticClass:"el-icon-close"})])]):e._e()])},M=[],B={name:"preview-page",props:{videoUrl:String,showVideo:Boolean,pageData:{type:Object,require:!0,default:function(){return{width:0,height:0}}}},data:function(){return{style:function(){var e=this.pageData,t=e.width,a=e.height;return{width:t+"px",height:a+"px","margin-left":-t/2+"px","margin-top":-a/2+"px"}}}},computed:{$video:function(){return this.$refs.vueMiniPlayer.$video}},methods:{closePanel:function(){this.$emit("closePanel",!1)},getVideo:function(){return{url:this.videoUrl,muted:!1,loop:!1,preload:"auto",volume:1,autoplay:!1}}}},A=B,S=(a("070b"),Object(w["a"])(A,U,M,!1,null,"54b966cc",null)),E=S.exports,F={components:{previewWrapper:E},props:{pageId:String},data:function(){return{pageData:{videoUrl:null},showDialog:!1}},mounted:function(){this.getData()},methods:{closePanel:function(){this.$emit("closePreview",!1)},getData:function(){var e=this;this.pageData={videoUrl:null},this.loading=!0,this.$API.getPageDetail({pageId:this.pageId}).then((function(t){e.pageData=t.body,e.pageData.videoUrl||(e.showDialog=!0)})).catch((function(){e.showDialog=!0}))},handleClose:function(){this.closePanel()}}},N=F,q=(a("f27d"),Object(w["a"])(N,x,T,!1,null,"33d250c4",null)),z=q.exports,V={components:{thumbnailPanel:L,previewPage:z},data:function(){return{loading:!1,pageList:[],myCount:0,shareCount:0,pageModeList:[],searchParams:{type:"my",pageMode:"h5"},previewId:"",showPreview:!1}},computed:{},created:function(){this.pageModeList=this.$config.pageModeList,this.getPageList()},methods:{operationBtn:function(e){var t=["edit","copyTemplate","setTemplate"];return"my"===this.searchParams.type&&(t=[].concat(Object(c["a"])(t),["cooperation","delete"])),"cooperation"===this.searchParams.type&&(t=[].concat(Object(c["a"])(t),["unCooperation"])),t=[].concat(Object(c["a"])(t),e?["copyUrl","viewPageData"]:["publish"]),t},doSearch:function(e){this.searchParams.type=e,this.getPageList()},handlePageModeClick:function(e){this.searchParams.pageMode=e.name,this.getPageList()},getPageList:function(){var e=this;this.$API.GetPageList(this.searchParams).then((function(t){e.pageList=t.body.pages||[],e.myCount=t.body.myPageCount,e.shareCount=t.body.myCooperationPageCount}))},showPreviewFn:function(e){this.previewId=e,this.showPreview=!0}}},H=V,J=(a("f076"),a("4e5e"),Object(w["a"])(H,o,r,!1,null,"1d5ccbc5",null));t["default"]=J.exports},"474d":function(e,t,a){},"4b5a":function(e,t,a){e.exports=a.p+"static/img/headerImage.baefd97f.png"},"4e5e":function(e,t,a){"use strict";a("a886")},"56c4":function(e,t,a){},5767:function(e,t,a){"use strict";a("9c39")},"67bf":function(e,t,a){e.exports=a.p+"static/img/pagecover.e918ae3e.jpg"},"9c39":function(e,t,a){},a886:function(e,t,a){},b25f:function(e,t,a){},f076:function(e,t,a){"use strict";a("fb17")},f27d:function(e,t,a){"use strict";a("56c4")},fb17:function(e,t,a){}}]);
//# sourceMappingURL=chunk-a1bda2fc.653d395e.js.map